<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Roblox OSINT Dashboard</title>

<style>
* { box-sizing: border-box; font-family: system-ui, sans-serif; }
body {
  background: #0b0b0b;
  color: #fff;
  padding: 30px;
  display: flex;
  justify-content: center;
}
.container {
  width: 900px;
  background: #121212;
  border-radius: 16px;
  padding: 25px;
  box-shadow: 0 30px 80px rgba(0,0,0,.6);
}
input, button {
  padding: 10px;
  border-radius: 8px;
  border: none;
}
input { background: #1e1e1e; color: white; width: 100%; }
button {
  background: #5865f2;
  color: white;
  font-weight: 600;
  cursor: pointer;
}
.section {
  margin-top: 20px;
}
.section h2 {
  cursor: pointer;
  font-size: 18px;
}
.hidden { display: none; }
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 12px;
}
.card {
  background: #1a1a1a;
  padding: 10px;
  border-radius: 10px;
  text-align: center;
  font-size: 13px;
}
.card img {
  width: 80px;
  height: 80px;
  border-radius: 10px;
}
.filter {
  margin: 10px 0;
}
pre {
  background: #1a1a1a;
  padding: 12px;
  border-radius: 10px;
  font-size: 13px;
  overflow-x: auto;
}
a { color: #8ab4ff; text-decoration: none; }
.loading { color: #facc15; }
</style>
</head>

<body>
<div class="container">

<h1>Roblox OSINT Dashboard</h1>

<input id="userInput" placeholder="Username or User ID">
<button onclick="inspect()">Inspect</button>

<div id="status"></div>
<div id="output"></div>

</div>

<script>
/* ================= HELPERS ================= */

async function fetchJSON(url, opts) {
  const res = await fetch(url, opts)
  if (!res.ok) throw "Fetch failed"
  return res.json()
}

async function resolveUserId(input) {
  if (/^\d+$/.test(input)) return input
  const res = await fetchJSON("https://users.roproxy.com/v1/usernames/users", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ usernames: [input] })
  })
  if (!res.data.length) throw "User not found"
  return res.data[0].id
}

/* ================= DATA ================= */

async function getProfile(userInput) {
  const userId = await resolveUserId(userInput)

  const [
    user,
    usernames,
    friends,
    groups
  ] = await Promise.all([
    fetchJSON(`https://users.roproxy.com/v1/users/${userId}`),
    fetchJSON(`https://users.roproxy.com/v1/users/${userId}/username-history?limit=50&sortOrder=Asc`),
    fetchJSON(`https://friends.roproxy.com/v1/users/${userId}/friends`),
    fetchJSON(`https://groups.roproxy.com/v2/users/${userId}/groups/roles`)
  ])

  return { userId, user, usernames: usernames.data, friends: friends.data, groups: groups.data }
}

/* ================= USERNAME SIMILARITY ================= */

async function findSimilarUsernames(username) {
  const res = await fetchJSON(
    `https://users.roproxy.com/v1/users/search?keyword=${encodeURIComponent(username)}&limit=10`
  )
  return res.data
}

/* ================= UI ================= */

function toggle(id) {
  document.getElementById(id).classList.toggle("hidden")
}

async function inspect() {
  const input = document.getElementById("userInput").value.trim()
  const status = document.getElementById("status")
  const out = document.getElementById("output")

  status.textContent = "Loading..."
  status.className = "loading"
  out.innerHTML = ""

  try {
    const p = await getProfile(input)
    const similar = await findSimilarUsernames(p.user.name)

    status.textContent = ""

    out.innerHTML = `
      <div class="section">
        <h2 onclick="toggle('basic')">▶ Basic Info</h2>
        <div id="basic">
          <pre>${JSON.stringify(p.user, null, 2)}</pre>
        </div>
      </div>

      <div class="section">
        <h2 onclick="toggle('names')">▶ Past Usernames</h2>
        <div id="names">
          <pre>${p.usernames.map(u => u.name).join(", ")}</pre>
        </div>
      </div>

      <div class="section">
        <h2 onclick="toggle('groups')">▶ Groups</h2>
        <input class="filter" placeholder="Filter groups..." oninput="
          [...document.querySelectorAll('.group')].forEach(g=>{
            g.style.display = g.textContent.toLowerCase().includes(this.value.toLowerCase())?'block':'none'
          })
        ">
        <div id="groups">
          ${p.groups.map(g => `
            <div class="group card">
              <strong>${g.group.name}</strong><br>
              ${g.role.name} (${g.role.rank})
            </div>
          `).join("")}
        </div>
      </div>

      <div class="section">
        <h2 onclick="toggle('friends')">▶ Friends</h2>
        <input class="filter" placeholder="Filter friends..." oninput="
          [...document.querySelectorAll('.friend')].forEach(f=>{
            f.style.display = f.textContent.toLowerCase().includes(this.value.toLowerCase())?'block':'none'
          })
        ">
        <div id="friends" class="grid">
          ${p.friends.map(f => `
            <div class="friend card">
              <img src="https://thumbnails.roproxy.com/v1/users/avatar-headshot?userIds=${f.id}&size=100x100&format=Png">
              <div>${f.name}</div>
            </div>
          `).join("")}
        </div>
      </div>

      <div class="section">
        <h2 onclick="toggle('similar')">▶ Similar Usernames</h2>
        <div id="similar" class="grid">
          ${similar.map(u => `
            <div class="card">
              <img src="https://thumbnails.roproxy.com/v1/users/avatar-headshot?userIds=${u.id}&size=100x100&format=Png">
              <div>${u.name}</div>
            </div>
          `).join("")}
        </div>
      </div>
    `
  } catch (e) {
    status.textContent = "Failed to load user"
    console.error(e)
  }
}
</script>
</body>
</html>
