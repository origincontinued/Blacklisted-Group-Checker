<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Roblox OSINT Alt Dashboard</title>

<style>
* { box-sizing: border-box; font-family: system-ui, sans-serif; }
body { background:#0b0b0b; color:#fff; padding:30px; }
.container { max-width:1200px; margin:auto; background:#121212; padding:25px; border-radius:16px; }
input,button { padding:10px; border-radius:8px; border:none; }
input { background:#1e1e1e; color:white; width:100%; }
button { background:#5865f2; color:white; font-weight:600; cursor:pointer; }
.section { margin-top:20px; }
.section h2 { cursor:pointer; }
.hidden { display:none; }
.grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:12px; }
.card { background:#1a1a1a; padding:10px; border-radius:10px; text-align:center; font-size:13px; }
.card img { width:80px; height:80px; border-radius:10px; }
.low{color:#4ade80} .mid{color:#facc15} .high{color:#f87171}
pre{background:#1a1a1a;padding:12px;border-radius:10px;overflow:auto;font-size:12px}
</style>
</head>

<body>
<div class="container">

<h1>Roblox OSINT / Alt-Analysis Dashboard</h1>

<input id="userA" placeholder="Primary user (username or ID)">
<input id="userB" placeholder="Optional comparison user">
<button onclick="analyze()">Analyze</button>
<button onclick="exportJSON()">Export JSON</button>

<div id="status"></div>
<div id="out"></div>

</div>

<script>
const TARGET_GROUP = 4219097
let CASE_DATA = {}

const fetchJSON=(u,o)=>fetch(u,o).then(r=>r.json())
const days=d=>Math.floor((Date.now()-new Date(d))/86400000)

async function resolve(input){
  if(/^\d+$/.test(input)) return input
  const r=await fetchJSON("https://users.roproxy.com/v1/usernames/users",{
    method:"POST",headers:{"Content-Type":"application/json"},
    body:JSON.stringify({usernames:[input]})
  })
  return r.data[0].id
}

const getUser=id=>fetchJSON(`https://users.roproxy.com/v1/users/${id}`)
const getGroups=id=>fetchJSON(`https://groups.roproxy.com/v2/users/${id}/groups/roles`)
const getFriends=id=>fetchJSON(`https://friends.roproxy.com/v1/users/${id}/friends`)
const head=id=>`https://thumbnails.roproxy.com/v1/users/avatar-headshot?userIds=${id}&size=100x100&format=Png`

function score(base,other){
  let s=0, reasons=[]
  if(other.name.toLowerCase().includes(base.name.slice(0,4).toLowerCase())){s+=25;reasons.push("Name similarity")}
  const ageDiff=Math.abs(days(base.created)-days(other.created))
  if(ageDiff<30){s+=25;reasons.push("Creation proximity")}
  const sharedGroups=base.groups.filter(g=>other.groups.some(og=>og.group.id===g.group.id)).length
  if(sharedGroups){s+=Math.min(sharedGroups*10,30);reasons.push("Shared groups")}
  const mutual=base.friends.filter(f=>other.friends.some(of=>of.id===f.id)).length
  if(mutual){s+=Math.min(mutual*5,20);reasons.push("Mutual friends")}
  if(other.groups.some(g=>g.group.id===TARGET_GROUP)) {s+=10;reasons.push("Target group")}
  return {score:Math.min(s,100),reasons}
}

function toggle(id){document.getElementById(id).classList.toggle("hidden")}

async function analyze(){
  const A=document.getElementById("userA").value.trim()
  const B=document.getElementById("userB").value.trim()
  const out=document.getElementById("out")
  out.innerHTML="Analyzing…"

  const aId=await resolve(A)
  const aUser=await getUser(aId)
  const aGroups=(await getGroups(aId)).data
  const aFriends=(await getFriends(aId)).data

  const friendDetails=await Promise.all(aFriends.map(async f=>{
    const u=await getUser(f.id)
    const g=(await getGroups(f.id)).data
    return {...u,groups:g,friends:[]}
  }))

  const friendsInTarget=friendDetails.filter(f=>f.groups.some(g=>g.group.id===TARGET_GROUP))

  CASE_DATA={aUser,aGroups,aFriends,friendDetails,friendsInTarget}

  out.innerHTML=`
  <div class="section">
    <h2 onclick="toggle('groups')">▶ All Groups (${aGroups.length})</h2>
    <div id="groups">
      ${aGroups.map(g=>`
        <div class="card">${g.group.name}<br>${g.role.name} (${g.role.rank})</div>
      `).join("")}
    </div>
  </div>

  <div class="section">
    <h2 onclick="toggle('g4219')">▶ Friends in Group ${TARGET_GROUP}</h2>
    <div id="g4219" class="grid">
      ${friendsInTarget.map(f=>`
        <div class="card">
          <img src="${head(f.id)}">
          ${f.name}
        </div>
      `).join("")}
    </div>
  </div>

  <div class="section">
    <h2 onclick="toggle('alt')">▶ Alt Likelihood Scoring</h2>
    <div id="alt" class="grid">
      ${friendDetails.map(f=>{
        const r=score(
          {name:aUser.name,created:aUser.created,groups:aGroups,friends:aFriends},
          {...f,friends:aFriends}
        )
        return`
        <div class="card">
          <img src="${head(f.id)}">
          ${f.name}<br>
          <span class="${r.score>70?'high':r.score>40?'mid':'low'}">${r.score}%</span>
        </div>`
      }).join("")}
    </div>
  </div>

  <div class="section">
    <h2 onclick="toggle('timeline')">▶ Account Age Timeline</h2>
    <pre id="timeline">${
      [aUser,...friendDetails]
        .sort((a,b)=>new Date(a.created)-new Date(b.created))
        .map(u=>`${u.name} – ${days(u.created)} days`)
        .join("\n")
    }</pre>
  </div>
  `
}

function exportJSON(){
  const blob=new Blob([JSON.stringify(CASE_DATA,null,2)],{type:"application/json"})
  const a=document.createElement("a")
  a.href=URL.createObjectURL(blob)
  a.download="roblox_osint_case.json"
  a.click()
}
</script>
</body>
</html>
